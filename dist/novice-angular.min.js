angular.module("noviceDirectives",["2lykUtils"]),angular.module("noviceDirectives").directive("noviceList",["lykPropertyAccess","$timeout","lykConsole",function(a,b,c){return{restrict:"EA",templateUrl:function(a,b){return b.templateUrl?b.templateUrl:"novice/template/novice-list/novice-list.html"},transclude:!0,require:"ngModel",scope:{pColumns:"=columns",model:"=ngModel",pSelectFn:"=?selectFn",pSearchFn:"=?searchFn",sortFn:"=?",bottomFn:"=?",querySearchFn:"=?",defaultSort:"@",defaultOrder:"@",hideList:"=?",pButtons:"=?buttons",tableClass:"=?",tableHeight:"=?"},link:function(d,e,f,g){function h(a){c.dev("[noviceList]","selectFn"),"function"==typeof d.pSelectFn&&d.pSelectFn(a)}function i(a){c.dev("[noviceList]","searchFn"),"function"==typeof d.pSearchFn&&d.pSearchFn(a)}function j(a,b,d,e){c.dev("[noviceList]","actionFn"),a&&angular.isObject(a)&&"function"==typeof a.action&&a.action(b,d,e)}function k(b,c,d,e){var f,g=a.async.getValue(b,c);return f=g.$$state.value,void 0===f&&d&&d.alternative&&(g=a.async.getValue(b,d.alternative),f=g.$$state.value),!e&&d&&angular.isArray(d.inner)&&angular.isObject(f)&&(f=d.inner.map(function(b){return a.getValue(f,b)}).join(" ")),d&&d.filter&&(f=d.filter(f,c,b)),f}c.dev("[noviceList]"),d.__do=function(){var a=Array.prototype.shift.call(arguments),c=arguments;d[a]&&b(function(){d[a].apply(this,c)},10)},d.youCanStickTheHeader=!1,d.setYouCanStickTheHeader=function(){d.youCanStickTheHeader=!0};var l={};d.isActiveRow=function(a){return l==a},d.activeRow=function(a){l=a};var m="";d.order="asc"==d.defaultOrder,d.sort,d.setSort=function(a,b,c,e){if(b||(d.isSortedBy(a)?d.order=!d.order:d.order=!0),m=a,"function"==typeof d.sortFn)return void d.sortFn(m,d.order);d.sort=function(b){return k(b,a,e)},d.reverse=!d.order},d.isSortedBy=function(a){return m==a},d.getValue=k,d.getArray=function(a,b,c){var e=[];return angular.isObject(a)&&"array"==d.getType(a,b,c)&&(e=k(a,b,c,!0)),e},d.getType=function(b,c,d){if(d.type)return d.type;var e=a.getType(b,c);return"undefined"==e&&d&&d.alternative&&(e=a.getType(b,d.alternative)),e},d.selectFn=h,d.searchFn=i,d.actionFn=j,d.defaultSort=d.defaultSort||"",d.defaultSort&&d.setSort(d.defaultSort,!0),d.loaded=!0,d.$watchCollection("pButtons",function(a){d.buttons=angular.isArray(a)?a:[]},!0),d.$watchCollection("model",function(a){d.rows=a},!0),d.$watchCollection("pColumns",function(a){if(!angular.isArray(a))return void(d.columns=[]);var b=angular.copy(a);d.actionsColumn=b.filter(function(a){return a&&angular.isObject(a)&&"actions"===a.type}),d.actionsColumn=d.actionsColumn.length>0?d.actionsColumn[0]:void 0,d.columns=b.filter(function(a){return angular.isString(a)&&""!=a.trim()||a&&angular.isObject(a)&&(void 0===a.type||angular.isString(a.type)&&-1==["actions"].indexOf(a.type))}).map(function(a){return angular.isString(a)&&(a={id:a}),a.name=a.name||a.id,a.sortable=a.sortable||!1,a.filter=a.filter||void 0,a.class=a.class||"",a.type=a.type||void 0,a.inner=angular.isArray(a.inner)?a.inner:void 0,a.alternative=angular.isString(a.alternative)?a.alternative:void 0,a})},!0)}}}]),angular.module("noviceDirectives").directive("noviceListXhr",["lykPropertyAccess","$timeout","lykXhr","lykConsole",function(a,b,c,d){return{templateUrl:function(a,b){return b.templateUrl?b.templateUrl:"novice/template/novice-list/novice-list-xhr.html"},transclude:!0,scope:{columns:"=",xhr:"<",xhrParams:"<",parametersNames:"<",myButtons:"=?buttons",hideFilters:"=?",querySearchFn:"=?",pSelectFn:"=?selectFn",tableHeight:"=?"},link:function(a,b,e){function f(b){var e={};e[l.limit]=g,e[l.page]=h,e[l.sort]=i,e[l.order]=j,e[l.search]=a.search?encodeURIComponent(a.search):void 0,["limit","page","sort","order","search"].forEach(function(a){void 0!==e[l[a]]&&""!==e[l[a]]||delete e[l[a]]}),c.execute(a.xhr,{params:e},a.xhrParams).then(function(c){if(!c)return d.dev("[noviceListXhr]","No data");if(angular.isArray(c))a.myList=b?c:a.myList.concat(c),d.dev("[noviceListXhr]","size:",a.myList.length);else if(angular.isObject(c)){var e="data";if(angular.isArray(c.docs)&&!angular.isArray(c.data)&&(e="docs"),!angular.isArray(c[e]))return d.dev("[noviceListXhr]","No data");a.myList=b?c[e]:a.myList.concat(c[e]),k=angular.isNumber(c.pages)?c.pages:k}},d.error)}var g=50,h=0,i="",j="",k=1,l={page:"page",limit:"limit",sort:"sort",order:"order",search:"search"};a.parametersNames&&angular.isObject(a.parametersNames)&&Object.keys(a.parametersNames).forEach(function(b){a.parametersNames[b]&&angular.isString(a.parametersNames[b])&&(l[b]=a.parametersNames[b])}),a.myList=[],e.hasOwnProperty("xhrSort")&&(a.sortMyList=function(a,b){i=a,j=b?"asc":"desc",h=0,f(!0)}),a.hideFilters||"function"!=typeof a.querySearchFn||(a.myQuerySearchFn=function(b){return!!a.hideFilters||a.querySearchFn(b,a.search)}),a.loadMore=function(){k<=h+1||(h++,f())},a.doSearch=function(){console.log("[noviceListXhr]","dont knx wut to do")},f()}}}]),angular.module("noviceDirectives").directive("noviceInputList",["$timeout","$q",function(a,b){return{restrict:"E",require:["ngModel"],templateUrl:function(a,b){return b.templateUrl||"novice/template/novice-inputs/novice-input-list.html"},scope:{options:"=?options"},controllerAs:"vm",bindToController:!0,controller:function(){function a(){return b.options&&angular.isObject(b.options)&&!angular.isArray(b.options)?b.options:{}}var b=this;this.newValue={text:""},this.duplicates=[],this.getOptions=a,this.add=function(){this.touched=!0;var b=a(),c=this.newValue;(b.allowEmpty||c.text)&&(this.model.push(c),this.newValue={text:""})},this.remove=function(a){this.touched=!0,this.model.splice(a,1)}},link:function(a,b,c,d){var e=d[0];a.getCtrl=function(){return e},e.$validators.required=function(b,c){var d=b||c||[];return!(a.vm.getOptions().required&&!d.length)},e.$validators.emptyNotAllowed=function(b,c){var d=b||c||[];return!(!a.vm.getOptions().allowEmpty&&d.length)||!d.some(function(a){return e.$isEmpty(a)})},e.$validators.duplicates=function(b,c){var d=b||c||[];return!(a.vm.getOptions().disallowDuplicates&&d.length&&d.some(function(b,c){return d.some(function(d,e){return e!=c&&d==b&&(a.vm.duplicates=[c,e],!0)})}))&&(a.vm.duplicates=[],!0)},a.$watch("vm.model",function(a){e.$setViewValue(a.map(function(a){return a.text})),e.$validate()},!0),e.$render=function(){angular.isArray(e.$viewValue)||(e.$viewValue=[]),a.vm.model=e.$viewValue.map(function(a){return{text:a}})}}}}]),angular.module("noviceFilters",[]),angular.module("noviceFilters").filter("timeFormat",function(){return function(a,b,c){if(!angular.isUndefined(a))switch(a=new Date(a),c){case"l":case"L":return d3.timeFormat(b)(a).toLowerCase();case"u":case"U":default:return d3.timeFormat(b)(a)}}}),angular.module("noviceApp",["2lykUtils","noviceRouter","noviceServices","noviceFilters","noviceDirectives","nApp"]),angular.module("noviceApp").run(["$rootScope",function(a){a.__novice={generatedAt:new Date}}]),angular.module("noviceRouter",["ngRoute","2lykUtils","noviceRouterServices","nApp"]),angular.module("noviceRouterServices",["ngRoute","2lykUtils"]),angular.module("noviceRouterServices").provider("Resolve",function(){var a={};this.add=function(b,c){angular.isObject(b)&&angular.isUndefined(c)?Object.keys(b).forEach(function(c){a[c]=b[c]}):a[b]=c},this.get=function(b){return a[b]},this.$get=function(){return{}}}),angular.module("noviceRouterServices").factory("noviceRouterService",["$route","lykConsole",function(a,b){function c(a,c,e){var f="",g={},h=d[a];if(c=c&&angular.isObject(c)?c:{},!h)return b.error("[noviceRouterService][path]","Route","'"+a+"'","not found"),"";if(h=angular.copy(h),f=h.originalPath,h.keys.length){if(h.keys.some(function(a){if(!a.optional&&angular.isUndefined(c[a.name]))return b.error("[noviceRouterService][path]","Missing param","'"+a.name+"'","for path","'"+h.originalPath+"'"),!0}))return"";Object.keys(c).forEach(function(a){var b=":"+a;f.indexOf(b)>-1?f=f.replace(new RegExp(b,"g"),c[a]):g[a]=c[a]})}else g=c;return Object.keys(g).length&&(f+="?",Object.keys(g).forEach(function(a,b,c){f+=a+"="+g[a],b+1<c.length&&(f+="&")})),e?angular.isString(e)&&(f=e+f):0==f.indexOf("/")&&(f=f.substring(1)),f}var d={},e=a.routes;return Object.keys(e).forEach(function(a){e[a].name&&(d[e[a].name]=e[a])}),{path:c}}]),angular.module("noviceRouter").config(["NOVICE_ROUTES","$routeProvider","ResolveProvider","lykConsoleProvider",function(a,b,c,d){function e(a,b){if(a.resolve&&angular.isString(a.resolve)){var d=c.get(a.resolve);d?a.resolve=d:console.error("resolve","'"+a.resolve+"'","not found in 'ResolveProvider' for route","'"+a.name+"'","'"+b+"'")}}function f(a){return!!a.main&&(g?(delete a.main,!1):(g=!0,!0))}if(angular.isArray(a)&&a.length>0){var g=!1;a.forEach(function(a){var c=a.path,g=a.baseUrl||"",h=a.routes,i=a.name,j=i;a.rootName=j;var k=!1;if(!c){if(!(Array.isArray(h)&&h.length>0))return;k=!0}if(e(a,c),!k){delete a.path;var l=f(a);return b.when(c,a),void(l&&(d.dev("[ROUTER]","main:",c),b.otherwise({redirectTo:c})))}h.forEach(function(a){var c=g+(a.path||"");if(a.name=a.name||i,a.rootName=j,c){e(a,c),delete a.path;var h=f(a);b.when(c,a),h&&(d.dev("[ROUTER]","main:",c),b.otherwise({redirectTo:c}))}})})}}]),angular.module("noviceRouter").run(["$rootScope","$window","$location","lykConsole","noviceRouterService",function(a,b,c,d,e){a.router=e,a.$on("$routeChangeStart",function(b,c){if(!c)return void d.error("404 NO ROUTE");var e=c.$$route;e&&(a._routeName=e.name,a._routeRootName=e.rootName,a._templateUrl=e.templateUrl,a._path=e.originalPath,a._controller=e.controller||"",d.dev("[RUN]",a._routeName||"",a._path))})}]),angular.module("noviceServices",[]),angular.module("noviceServices").factory("noviceUtils",["$timeout","$interval",function(a,b){function c(a,b,c){if(!b)return!0;if(!a)return!1;var d,e;return e=angular.isArray(b)?angular.copy(b):angular.isString(b)||angular.isNumber(b)?b.toString().split(" ").map(function(a){return a.trim()}):[],d=angular.isArray(a)?angular.copy(a):angular.isString(a)||angular.isNumber(a)?a.toString().split(" ").map(function(a){return a.trim()}):[],e.filter(function(a){return a&&angular.isString(a)}),!e.length||(d.filter(function(a){return a&&angular.isString(a)}),!!d.length&&(c||(e=e.map(function(a){return a.toLowerCase()}),d=d.map(function(a){return a.toLowerCase()})),!e.some(function(a){return!d.some(function(b){return b.indexOf(a)>-1})})))}function d(c){c.$on("$destroy",function(){e(c,[{name:"timeouts",service:a},{name:"intervals",service:b}])})}function e(a,b){b.forEach(function(b){var c=b.name,d=b.service;a[c]&&angular.isObject(a[c])&&Object.keys(a[c]).forEach(function(b){console.log(b,":",a[c][b]),a[c][b]&&d.cancel(a[c][b])})})}return{found:c,onDestroy:{cancelTimeouts:d}}}]),angular.module("noviceServices").provider("noviceStorage",function(){var a="_novice_storage_",b="";this.setPrefix=function(a){b=a,angular.isString(b)||(b=JSON.stringify(b))},this.$get=["$localStorage",function(c){function d(){return c[a]}function e(){delete c[a],c[a]={}}function f(a,c){d()[b+a]=c}function g(a){return d()[b+a]}function h(a){delete d()[b+a]}return c[a]&&angular.isObject(c[a])||(c[a]={}),{set:f,get:g,remove:h,getStorage:d,reset:e}}]});